# Unity-核心

### 模型的基本制作过程

3D模型的制作通常包括以下几个主要步骤：

1. **建模**  
   使用三角面片组合，像捏泥人一样拼装出模型的形状。

2. **展UV**  
   UV 是纹理贴图坐标的简称，具有U轴和V轴，类似于三维坐标系的XYZ轴。纹理坐标中的每一个点都和 3D 模型上的位置信息是相互联系的。展 UI 就像是将 3D 模型的表面“拆开”成一张 2D 图片上，方便后续贴图。
   > 如果对具体内容很感兴趣的，可以观看[【Kurt】Blender零基础入门教程 | Blender中文区新手必刷教程(已完结)](https://www.bilibili.com/video/BV14u41147YH/?spm_id_from=333.337.search-card.all.click&vd_source=b3c97e3d2220b29b554866d21d02bd09)

3. **材质和纹理贴图**  
   - **纹理**：一张 2D 图片，包含颜色、细节等信息。
   - **贴图**：通过 UV 坐标将纹理映射到 3D 模型表面。
   - **纹理贴图**：为模型提供颜色、细节、UV 等信息。
   - **材质**：决定模型的表现效果——结合纹理贴图和着色器算法，可呈现金属、塑料、玻璃等不同效果。

4. **骨骼绑定**  
   为模型添加骨骼结构，定义骨骼控制哪些网格区域，实现后续动画控制。

5. **动画制作**  
   利用骨骼的旋转、移动等操作，在时间轴上制作关键帧，通过插值规则让模型在关键帧之间平滑过渡，最终形成完整的动画效果。


## 2D

### 图片导入概述

Unity 支持多种图片格式，常见格式如下：

|格式| 特点描述|
|-----------|--------------------------------------------|
| JPG / JPEG  | 有损压缩，压缩率高，体积小，无透明通道。|
| PNG       | 无损压缩，体积小，支持透明通道。|
| TGA       | 支持不失真压缩，体积小，效果清晰。|
| BMP       | 几乎不压缩，文件体积大。|
| TIF       | 基本不损失图片信息，但体积大。|
| PSD       | Photoshop专用格式，可通过工具导入。|
| EXR / GIF / HDR / IFF / PIC | Unity也支持这些格式。|

最常用的格式为 JPG, PNG 和 TGA。

### `Texture Type` 纹理类型

纹理类型主要是为了让纹理图片有不同的主要用途，指明其是用于哪项工作的纹理。

**各类型概览**

| 类型 (Type)                | 主要用途                                                                 |
|----------------------------|--------------------------------------------------------------------------|
| Default                    | 最常用、最通用的类型，用于 3D 模型的纹理（如反照率贴图、金属度贴图等）。         |
| Normal Map                 | 用于存储法线信息，为模型表面增加凹凸细节，模拟高模的视觉效果。                 |
| Sprite (2D and UI)         | 用于 2D 游戏、UI 元素（如按钮、图标）和粒子系统。                             |
| Editor GUI and Legacy GUI  | 用于 Unity 编辑器扩展的 GUI 元素或旧版的 IMGUI 系统。                         |
| Cookie                     | 用作光源的“遮罩”，投射出特定形状或图案的光影，例如窗户透光的效果。             |
| Lightmap                   | 用于存储预烘焙的光照信息，是光照贴图（Lightmapping）流程的一部分。             |
| Cursor                     | 用于自定义硬件鼠标光标的图标。                                             |
| Single Channel             | 当你只需要图片的一个颜色通道（红、绿、蓝或 Alpha）时使用，可以节省内存。        |

**参数说明**

1. `Default`：
    ![Default参数](./images/Default.jpg)
    - `sRGB`：告诉 Unity 该纹理是伽马空间的（sRGB），在渲染时会自动进行颜色空间转换——采用线性光照计算后再进行伽马转换。
        `Alpha Source`：指定如何生成纹理的Alpha通道。
        - `None`：忽略 Alpha 通道。
        - `Input Texture Alpha`：直接使用图片文件自带的 Alpha 通道。
        - `From Gray Scale`：从输入纹理 RGB 值的平均值生成 Alpha 通道。
    - `Alpha Is Transparency`：如果你的 Alpha 通道用于表示透明度，勾选此项可以优化边缘的显示效果，避免出现白边或黑边。
    ::: details 伽马空间与线性空间
    结论来说，在 Unity 中采用线性颜色空间（Linear Color Space）可以提供更准确的光照和颜色计算，效果更自然。

    详情可阅读：[Gamma and Linear Space - What They Are and How They Differ](https://kinematicsoup.com/news/2016/6/15/gamma-and-linear-space-what-they-are-how-they-differ)

    热心网友提供的中文翻译版：[伽马空间与线性空间详解](https://gwb.tencent.com/community/detail/120396)
    :::

2. `Normal Map`：
    法线贴图就是在原物体的表面每个点上均做法线，法线就是垂直于某个点的切线的方向向量。
    ![NormalMap参数](./images/NormalMap.jpg)

    - `Create From Grayscale`：让 Unity 根据灰度图生成法线贴图，但效果完全没法和美术制作的法线贴图相比。
        - `Bumpiness`：控制凹凸程度，值越大凹凸感越强。
        - `Filtering`：如何计算凹凸值。
            - `Smooth`：使用标准算法生成法线贴图。
            - `Sharp`：生成比标准模式更锐利的法线贴图。
    ::: details 法线贴图
    法线贴图是一种特殊的纹理，它不存储颜色信息，而是存储模型表面的方向（法线）信息。

    一般美术所制作的模型是细节丰富的高模，但为了性能考虑。通常会将高模的多个三角面片合并，最终导出一个低模。为了在低模上保留高模的细节，在导出低模的同时，还会导出一张法线贴图。通过在低多边形模型上使用法线贴图，Unity 可以据此进行更加复杂的光照计算，模拟出高多边形模型才有的复杂表面细节，如砖缝、划痕、褶皱等，极大地提升了画质而无需增加模型的多边形数量。
    :::

3. `Editor GUI and Legacy GUI`：编辑器扩展——当你需要为 Unity 编辑器编写自定义窗口或 Inspector 面板时，所用的图标或图片应设为此类型。

4. `Sprite(2D and UI)`： Unity 中专门为 2D 游戏和用户界面（UI）设计的纹理类型
    - `Sprite Mode `：指定纹理是单一精灵还是精灵图集。
        - `Single`：当你的图片文件（比如一个 PNG）里只包含一个独立的元素时使用。比如一个按钮的图标、一个道具的图标。
        - `Multiple`：当你的图片文件是一张“精灵图集 (Sprite Sheet)”，包含了多个需要被切割出来的元素时使用。最常见的例子就是一个角色的所有动画帧都画在一张大图上。
        - `Polygon`：不使用图片原始的矩形边界，而是为这个 Sprite 手动定义一个自定义的多边形网格形状。
    - `Pixels Per Unit`：指定每个像素对应的世界单位数，影响精灵在场景中的大小。如同比例尺，决定了你的精灵在游戏场景里显示出来有多大。
    - `Mesh Type`：指定精灵的网格类型（只有 `Single` 和 `Multiple` 模式下有）。
        - `Full Rect`：创建四边形，将精灵显示在整个四边形上。
        - `Tight`：基于像素的 Alpha 值来生成网格，更加贴合精灵图片形状。
            > 任何小于 32x32 的精灵都会被自动设置为 Full Rect，无法使用 Tight。
    - `Extrude Edges`：在精灵的边缘添加额外的像素，可以用于防止锯齿状边缘。
    - `Pivot`：指定轴心点（仅可用于 `Single` 模式）。
    - `Generate Physics Shape`：自动生成物理碰撞体，适用于需要物理交互的精灵（仅在 `Single` 和 `Multiple` 模式）。
    - `Sprite Editor`：打开精灵编辑器，允许对精灵进行切割、调整和编辑。

5. `Cursor`：自定义光标。

6. `Cookie`光源剪影格式。
    - `LightType`：应用的光源类型。一般点光源的剪影需要设置为立方体纹理，方向光和聚光灯的剪影设置为 2D 纹理。
        - `Spotlight`：聚光灯类型，需要边缘纯黑色纹理。
        - `Directional`：方向光，平铺纹理。
        - `Point`：点光源，需要设置为立方体形状。
    - 与 `Default` 相同的参数不再赘述。

7. `LightMap / Directional Lightmap`：是 Unity 光照烘焙（Lighting Baking）系统的产物。这个类型通常由 Unity 自动设置，你很少需要手动去更改它。

8. `Single Channel`：单通道模式。这个模式能让一张贴图在内存里的占用空间减少 75%，但代价是它会丢掉所有颜色信息，只保留一张灰度图。
    - `Channel`：希望将纹理处理为 Alpha 还是 Red 通道。
        - `Alpha`：使用 Alpha 通道，不允许进行压缩。
        - `Red`：使用红色通道。

::: details 通道
通道是指图像中每个像素的颜色信息存储方式。例如：aRGB 三个通道，每个通道存储 8 位（0-255），代表不同的颜色信息，Alpha 通道则用于存储透明度信息。
:::

### `Texture Shape` 纹理形状

纹理不仅可以用于模型贴图，还可以用于制作天空盒和反射探针。纹理形状决定了你的纹理数据在内存中是如何组织的，以及它被用来做什么。它不再是关于纹理的“内容”（比如是颜色还是法线），而是关于它的“维度和结构。

不同类型的具体参数了解即可。

#### `2D`

`2D` 纹理是最常用的类型，这些纹理将用到模型和 GUI 上。

**参数说明**
- `Mapping`（映射）
    - `Auto`：根据纹理信息自动创建布局。
    - `6 Frames Layout (Cubic Environment)`：纹理包含标准立方体贴图布局之一排列的六个图像。
    - `Latitude-Longitude Layout (Cylindrical)`：将纹理映射到2D维度（经度/纬度）。
    - `Mirrored Ball (Spheremap)`：将纹理映射到类似球体的立方体贴图上。

#### `Cube`

立方形贴图，主要用于天空盒和反射探针。

**参数说明**
- `Convolution Type`（卷积类型）
    - `None`：无过滤。
    - `Specular (Glossy Reflection)`：将立方体作为反射探针。
    - `Diffuse (Irradiance)`：将纹理进行过滤表示辐照度，可作为光照探针。

- `Fixup Edge Seams`（修复边缘缝隙）
    - 作用：当`Convolution Type`为`None`和`Diffuse`时可用，解决低端设备上立方体贴图过滤错误。


#### `2D Array` 
这是一个更高级的、用于优化的形状。它像是一“叠”尺寸和格式都完全相同的 2D 贴图。主要作用为在着色器 (Shader) 中进行高性能的纹理切换。

可以用于：
- 精灵动画（替代 `Animation Sheet`，减少 Draw Call）
- 地形分层（如不同地貌的混合）
- Variants 材质（同一物体的不同皮肤/状态）

#### `3D`

`3D` 纹理是一个立体的纹理，通常用于存储体积数据，如体素、烟雾模拟等。

适用于：
- 体积效果（云、雾、火焰）
- 颜色查找表 (LUT - Look-Up Table)


### `Advanced` 纹理高级设置
在 Unity 导入纹理时，`Advanced`（高级）设置面板允许你对纹理的底层行为进行更细致的控制，适用于有特殊需求的项目或美术资源优化。


**参数说明**

- `Non-Power of 2`：非2的幂尺寸纹理的处理方式。美术资源使用2的幂尺寸便于压缩和 GPU 优化。
    - `None`：保留原始尺寸。
    - `ToNearest`：将纹理尺寸缩放为最接近的2的幂尺寸。
    - `ToLarger`：将纹理尺寸向上缩放到最接近的2的幂尺寸。
    - `ToSmaller`：将纹理尺寸向下缩放到最接近的2的幂尺寸。
    ::: tip
    PVRTC 格式要求纹理必须为正方形。
    :::

- `Read / Write Enable`：是否允许脚本在运行时读取/修改纹理数据。勾选后可用Texture2D.GetPixels等API，但会增加内存占用。只有需要脚本动态处理纹理时才建议开启。

- `Virtual Texture Only`：仅用于虚拟纹理系统（如大型场景地形），一般项目无需勾选。

- `Generate Mipmaps`：是否自动生成 MipMap（多级渐进纹理），用于提升远距离渲染效果和性能。大多数贴图建议开启，UI图标等特殊用途可关闭。
    - `Use Mipmap Limits`：是否启用 MipMap 限制（配合 MipMap Limit Group 使用），可针对不同平台或场景优化纹理内存。
            - `Mipmap Limit Group`：选择MipMap限制分组，便于统一管理和调整 MipMap 策略。适合大型项目或多平台适配。
    - `Mip Streaming`（了解即可）：启用可以使用纹理串流，主要用于控制 MipMap 的加载级别，用于减少 Unity 对纹理所需内存的的总量，性能换内存。可以通过设置 `Priority` 来控制优先考虑的 MipMap 层级。
    - `Mipmap Filtering`（了解即可）：MipMap 过滤算法（如 Box、Kaiser、Mitchell），影响 MipMap 生成的质量和锐度。Box 适合大多数情况，Kaiser 和Mitchell 更锐利但计算量略大。
    - `Preserve Coverage`（了解即可）：保持 Alpha 覆盖率，防止生成 MipMap 后透明区域变小，常用于有透明通道的贴图（如UI、特效）。
    - `Replicate Border`（了解即可）：复制边缘像素到纹理边界，防止UV采样超出范围时出现黑边或杂色。适合需要无缝贴图的场景。
    - `Fadeout to Gray`（了解即可）：让远距离的MipMap逐渐变为灰色，减少视觉干扰，适合特殊美术需求（如远景雾化效果）。
    ::: tip
    2D 游戏一般不使用 mipmap，3D 选择性使用。
    :::
- `Ignore PNG Gamma`：忽略PNG图片自带的Gamma信息，强制使用项目设置的颜色空间。一般建议保持默认，特殊色彩管理需求时可调整。
- `Swizzle`（了解即可）：通道重映射（R、G、B、A），可自定义纹理的颜色通道顺序，适合特殊 Shader 或美术需求。例如只用 Alpha 通道做遮罩时可将 A 映射到 R。

一般情况下，默认设置即可满足大多数项目需求。只有在遇到特殊性能瓶颈或美术需求时，才建议深入调整这些高级参数。

::: details MipMap
在三维计算机图形的贴图渲染中有一个常用的技术被称为 Mipmapping。
为了加快渲染速度和减少图像锯齿，贴图被处理成由一系列被预先计算和优化过的图片组成的文件，这样的贴图被称为 mipmap。Mipmap 需要占用一定的内存空间。

Mipmap 中每一个层级的小图都是主图的一个特定比例的缩小细节的复制品。
虽然在某些必要的视角，主图仍然会被使用，来渲染完整的细节。但是当贴图被缩小或者只需要从远距离观看时，mipmap 就会转换到适当的层级。

因为 mipmap 贴图需要被读取的像素远少于普通贴图，所以渲染的速度得到了提升。
而且操作的时间减少了，因为 mipmap 的图片已经是做过抗锯齿处理的，从而减少了实时渲染的负担。同时，放大和缩小也因为 mipmap 而变得更有效率。

如果贴图的基本尺寸是 256x256 像素的话,它 mipmap 就会有8个层级，每个层级是上一阶层级的四分之一的大小：128x128;64x64;32x32;16x16;8x8;4x4;2x2;1x1(一个像素)

简单来说，开启 MipMap 功能后，Unity 会帮助我们根据图片信息生成 n 张不同分辨率的图片，在场景中会根据我们离该模型的距离选择合适尺寸的图片用于渲染，提升渲染效率。
:::



