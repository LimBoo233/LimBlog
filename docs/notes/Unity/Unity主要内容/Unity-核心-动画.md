# Unity-核心-动画

::: details 模型的基本制作过程

3D模型的制作通常包括以下几个主要步骤：

1. **建模**  
   使用三角面片组合，像捏泥人一样拼装出模型的形状。

2. **展UV**  
   UV 是纹理贴图坐标的简称，具有U轴和V轴，类似于三维坐标系的XYZ轴。纹理坐标中的每一个点都和 3D 模型上的位置信息是相互联系的。展 UI 就像是将 3D 模型的表面“拆开”成一张 2D 图片上，方便后续贴图。
   > 如果对具体内容很感兴趣的，可以观看[【Kurt】Blender零基础入门教程 | Blender中文区新手必刷教程(已完结)](https://www.bilibili.com/video/BV14u41147YH/?spm_id_from=333.337.search-card.all.click&vd_source=b3c97e3d2220b29b554866d21d02bd09)

3. **材质和纹理贴图**  
   - **纹理**：一张 2D 图片，包含颜色、细节等信息。
   - **贴图**：通过 UV 坐标将纹理映射到 3D 模型表面。
   - **纹理贴图**：为模型提供颜色、细节、UV 等信息。
   - **材质**：决定模型的表现效果——结合纹理贴图和着色器算法，可呈现金属、塑料、玻璃等不同效果。

4. **骨骼绑定**  
   为模型添加骨骼结构，定义骨骼控制哪些网格区域，实现后续动画控制。

5. **动画制作**  
   利用骨骼的旋转、移动等操作，在时间轴上制作关键帧，通过插值规则让模型在关键帧之间平滑过渡，最终形成完整的动画效果。

:::

## Animation 窗口
Animation 窗口是 Unity 中用于创建和编辑动画片段（`Animation Clip`）的核心工具。通过该窗口，你可以为对象添加关键帧，调整属性曲线，预览动画效果，实现角色、UI 或场景元素的动态表现。它支持逐帧编辑、曲线调整和事件插入，是动画工作流程的基础。

![Animation窗口](./images/Animation窗口.png)

Animation 窗口提供了用于制作单个动画片段的功能，通常位于窗口左上角，功能从左到右分别是：
1. `Preview`：预览当前动画片段的效果。
2. 录制模式
3. 回到第一帧
4. 回到上一关键帧
5. 播放/暂停
6. 前进到下一关键帧
7. 回到最后一帧
8. 显示当前为第几帧

窗口右上角的三个点按钮可以进行更细腻的设置，如动画帧率。

窗口下方还有两个按钮：`DopeSheet`（关键帧模式） 和 `Curves`（曲线模式），用于编辑关键帧。

## 编辑关键帧
> 真正的动画一般都是美术同学制作，程序只要会简单的动画编辑（ex：位移）即可。

选择希望编辑的对象后，在 Animation 窗口中点击 `Create` 按钮为其创建一个新的动画片段，如果先前已经为该物体创建过动画，则点击左侧的动画片段下拉菜单点击 `Create New Clip` 创建新的动画片段。Unity 会自动为物体进行必要的设置：添加 `Animator` 组件，创建 `Animator Controller` 动画状态机并与 `Animator` 关联。

录制模式下，修改 Inspector 面板中物体的属性（如位置、旋转、缩放等），Unity 会自动为这些属性添加关键帧并创建过渡：
![关键帧模式](./images/关键帧模式.png)

可以在 `Curves` 模式下修改关键帧的插值曲线，调整动画的缓动效果：
![曲线模式](./images/曲线模式.png)

在 `Curves` 模式下可以直接拖动关键帧曲线的斜线来调整动画的插值效果，或者在关键帧上右键进行更细致的编辑：
| 切线模式 | 功能 |
| ---- | ---- |
| `Clamped Auto` | 自动插值，保持曲线平滑。 |
| `Auto` | 旧版自动插值，现在几乎不使用。 |
| `Free Smooth ` | 允许您自由地、手动地拖拽关键帧两侧的切线控制柄。 |
| `Flat` | 强制将关键帧两侧的切线都设置为完全水平。 |
| `Broken` | 允许独立地、分别地调整关键帧两侧的切线控制柄。 |

| 插值 | 功能 |
| ---- | ---- |
| `Free` | `Free Smooth` 和 `Broken` 模式的统称或前置状态。当您将一个关键帧的切线设置为 `Free` 时，意味着您放弃了自动计算（如 `Clamped Auto`），转为手动控制。 |
| `Linear` | 在两个关键帧之间创建一条笔直的线。 |
| `Constant` | 一个关键帧的值会保持不变，直到下一个关键帧的时刻，才瞬间跳转到新的值。|
| `Weighted` | 允许您在两个关键帧之间创建一个平滑的过渡，但与 `Free Smooth` 不同的是，它会考虑到关键帧的权重：可以将加权切线的控制柄“拉得更远”或“收得更近”。拉得越远，该切线对曲线形状的“引力”就越强，变化至该关键帧的视觉效果越快。|

## `Animation Clip` 文件
`Animation Clip` 储存了一个动画片段的所有信息。其中的属性大部分不用修改：
| 属性 | 功能 |
| ---- | ---- |
| `Loop Time` | 是否循环播放动画。 |
| `Loop Pose` | 循环播放后是否自动过度至起始状态。|
| `Cycle Offset` | 循环动画在开始播放时的延迟播放偏移量。|

在 Debug 面板（Inspector 右上角三个点按钮列表中开启）下，`Animation Clip` 文件的 Inspector 面板会显示更多信息，如 `Sample Rate` （每秒帧数）和 `Wrap Mode`（循环模式）等。

## 有限状态机
状态机（State Machine） 是一种将复杂行为分解为一系列独立、清晰的状态，并定义这些状态之间如何切换的设计模式。一个对象在任何特定时刻只能处于一种状态。

**状态机的三大核心要素**
1. **状态 (States)**

    代表一个对象在某个时刻所处的具体状况或行为。每个状态都是独立的。
2. **过渡 (Transitions)**

    连接两个状态的路径或规则，定义了从一个状态切换到另一个状态的可能性。

3. **条件 (Conditions) 或 事件 (Events)**

    触发过渡的具体原因。当某个条件满足时，状态机就会沿着预设的过渡路径切换到新的状态。

## `Animator Controller`

`Animator Controller` 是一个存在于您项目中的资产文件（以 `.controller` 为后缀）。它的核心作用是管理一个对象的所有动画片段（`Animation Clip`），并根据预设的逻辑和来自代码的指令，决定在何时播放哪个动画，以及动画之间如何过渡。